// Real geographic coordinates [longitude, latitude] for react-simple-maps
export const countryCoordinates = {
    // América
    'ESTADOS UNIDOS': [-98.5, 39.8],
    'USA': [-98.5, 39.8],
    'WASHINGTON': [-77.0, 38.9],
    'CANADA': [-106.3, 56.1],
    'CANADÁ': [-106.3, 56.1],
    'MEXICO': [-102.5, 23.6],
    'MÉXICO': [-102.5, 23.6],
    'BRASIL': [-51.9, -14.2],
    'BRAZIL': [-51.9, -14.2],
    'ARGENTINA': [-63.6, -38.4],
    'CHILE': [-71.5, -35.7],
    'PERU': [-75.0, -9.2],
    'PERÚ': [-75.0, -9.2],
    'BOLIVIA': [-65.0, -16.3],
    'COLOMBIA': [-74.3, 4.6],
    'VENEZUELA': [-66.6, 6.4],
    'URUGUAY': [-55.8, -32.5],
    'PARAGUAY': [-58.4, -23.4],
    'ECUADOR': [-78.2, -1.8],
    'PANAMA': [-80.8, 8.5],
    'PANAMÁ': [-80.8, 8.5],
    'COSTA RICA': [-84.0, 9.7],
    'GUATEMALA': [-90.2, 15.8],
    'CUBA': [-77.8, 21.5],
    'REPUBLICA DOMINICANA': [-70.2, 18.7],
    'REPÚBLICA DOMINICANA': [-70.2, 18.7],
    'HONDURAS': [-86.2, 15.2],
    'EL SALVADOR': [-88.9, 13.8],
    'NICARAGUA': [-85.2, 12.9],
    'TRINIDAD Y TOBAGO': [-61.2, 10.7],
    'JAMAICA': [-77.3, 18.1],

    // Europa
    'ESPAÑA': [-3.7, 40.5],
    'SPAIN': [-3.7, 40.5],
    'MADRID': [-3.7, 40.4],
    'FRANCIA': [2.2, 46.6],
    'FRANCE': [2.2, 46.6],
    'PARIS': [2.3, 48.9],
    'ALEMANIA': [10.5, 51.2],
    'GERMANY': [10.5, 51.2],
    'BERLIN': [13.4, 52.5],
    'BERLÍN': [13.4, 52.5],
    'ITALIA': [12.6, 41.9],
    'ITALY': [12.6, 41.9],
    'ROMA': [12.5, 41.9],
    'REINO UNIDO': [-3.4, 55.4],
    'UK': [-3.4, 55.4],
    'INGLATERRA': [-3.4, 55.4],
    'LONDRES': [-0.1, 51.5],
    'PORTUGAL': [-8.2, 39.4],
    'RUSIA': [105.3, 61.5],
    'RUSSIA': [105.3, 61.5],
    'MOSCU': [37.6, 55.8],
    'MOSCÚ': [37.6, 55.8],
    'SUECIA': [18.6, 60.1],
    'NORUEGA': [8.5, 60.5],
    'SUIZA': [8.2, 46.8],
    'AUSTRIA': [14.6, 47.5],
    'BELGICA': [4.5, 50.8],
    'BÉLGICA': [4.5, 50.8],
    'HOLANDA': [5.3, 52.1],
    'PAÍSES BAJOS': [5.3, 52.1],
    'POLONIA': [19.1, 51.9],
    'GRECIA': [21.8, 39.1],
    'UCRANIA': [31.2, 48.4],
    'RUMANIA': [25.0, 46.0],
    'REPUBLICA CHECA': [15.5, 49.8],
    'REPÚBLICA CHECA': [15.5, 49.8],
    'CHEQUIA': [15.5, 49.8],
    'CZECHIA': [15.5, 49.8],
    'CZECH REPUBLIC': [15.5, 49.8],
    'PRAGA': [14.4, 50.1],
    'HUNGRIA': [19.5, 47.2],
    'HUNGRÍA': [19.5, 47.2],
    'DINAMARCA': [9.5, 56.3],
    'FINLANDIA': [25.7, 61.9],
    'IRLANDA': [-8.2, 53.1],
    'CROACIA': [15.2, 45.1],
    'SERBIA': [21.0, 44.0],
    'BULGARIA': [25.5, 42.7],
    'ESLOVAQUIA': [19.7, 48.7],
    'ESLOVENIA': [14.6, 46.2],
    'LITUANIA': [23.9, 55.2],
    'LETONIA': [24.6, 56.9],
    'ESTONIA': [25.0, 58.6],

    // Asia
    'CHINA': [104.2, 35.9],
    'BEIJING': [116.4, 39.9],
    'JAPON': [138.3, 36.2],
    'JAPÓN': [138.3, 36.2],
    'TOKIO': [139.7, 35.7],
    'INDIA': [78.9, 20.6],
    'NUEVA DELHI': [77.2, 28.6],
    'COREA DEL SUR': [127.8, 35.9],
    'SEUL': [127.0, 37.6],
    'TAILANDIA': [100.5, 15.9],
    'BANGKOK': [100.5, 13.7],
    'VIETNAM': [108.3, 14.1],
    'SINGAPUR': [103.8, 1.4],
    'INDONESIA': [113.9, -0.8],
    'MALASIA': [101.7, 4.2],
    'FILIPINAS': [121.8, 12.9],
    'PAKISTAN': [69.3, 30.4],
    'TAIWAN': [121.0, 23.7],

    // Medio Oriente
    'ISRAEL': [34.9, 31.0],
    'TURQUIA': [35.2, 39.0],
    'TURQUÍA': [35.2, 39.0],
    'ANKARA': [32.9, 39.9],
    'ARABIA SAUDITA': [45.1, 23.9],
    'EMIRATOS ARABES': [53.8, 24.0],
    'EMIRATOS ÁRABES': [53.8, 24.0],
    'DUBAI': [55.3, 25.2],
    'QATAR': [51.2, 25.3],
    'KUWAIT': [47.5, 29.3],
    'IRAN': [53.7, 32.4],
    'IRÁN': [53.7, 32.4],
    'LIBANO': [35.5, 33.9],
    'LÍBANO': [35.5, 33.9],
    'JORDANIA': [36.2, 30.6],

    // África
    'SUDAFRICA': [22.9, -30.6],
    'SUDÁFRICA': [22.9, -30.6],
    'SOUTH AFRICA': [22.9, -30.6],
    'PRETORIA': [28.2, -25.7],
    'EGIPTO': [30.8, 26.8],
    'EL CAIRO': [31.2, 30.0],
    'MARRUECOS': [-7.1, 31.8],
    'ARGELIA': [1.7, 28.0],
    'NIGERIA': [8.7, 9.1],
    'KENIA': [37.9, -0.0],
    'ETIOPIA': [40.5, 9.1],
    'ETIOPÍA': [40.5, 9.1],
    'ANGOLA': [17.9, -11.2],
    'LIBIA': [17.2, 26.3],
    'MOZAMBIQUE': [35.5, -18.7],
    'GHANA': [-1.0, 7.9],
    'SENEGAL': [-14.5, 14.5],
    'TUNEZ': [9.5, 33.9],
    'TÚNEZ': [9.5, 33.9],

    // Oceanía
    'AUSTRALIA': [133.8, -25.3],
    'CANBERRA': [149.1, -35.3],
    'SIDNEY': [151.2, -33.9],
    'SYDNEY': [151.2, -33.9],
    'NUEVA ZELANDA': [174.9, -40.9],
    'NEW ZEALAND': [174.9, -40.9],
};

// Natural Earth English name → Spanish name mapping for geography highlighting
const geoNameAliases = {
    // Americas
    'UNITED STATES OF AMERICA': 'ESTADOS UNIDOS',
    'UNITED STATES': 'ESTADOS UNIDOS',
    'BRAZIL': 'BRASIL',
    'MEXICO': 'MÉXICO',
    'COLOMBIA': 'COLOMBIA',
    'ARGENTINA': 'ARGENTINA',
    'PERU': 'PERÚ',
    'VENEZUELA': 'VENEZUELA',
    'CHILE': 'CHILE',
    'ECUADOR': 'ECUADOR',
    'BOLIVIA': 'BOLIVIA',
    'PARAGUAY': 'PARAGUAY',
    'URUGUAY': 'URUGUAY',
    'PANAMA': 'PANAMÁ',
    'COSTA RICA': 'COSTA RICA',
    'GUATEMALA': 'GUATEMALA',
    'CUBA': 'CUBA',
    'DOMINICAN REP.': 'REPÚBLICA DOMINICANA',
    'DOMINICAN REPUBLIC': 'REPÚBLICA DOMINICANA',
    'HONDURAS': 'HONDURAS',
    'EL SALVADOR': 'EL SALVADOR',
    'NICARAGUA': 'NICARAGUA',
    'JAMAICA': 'JAMAICA',
    'TRINIDAD AND TOBAGO': 'TRINIDAD Y TOBAGO',
    'CANADA': 'CANADÁ',

    // Europe
    'FRANCE': 'FRANCIA',
    'GERMANY': 'ALEMANIA',
    'ITALY': 'ITALIA',
    'SPAIN': 'ESPAÑA',
    'UNITED KINGDOM': 'REINO UNIDO',
    'PORTUGAL': 'PORTUGAL',
    'RUSSIA': 'RUSIA',
    'SWEDEN': 'SUECIA',
    'NORWAY': 'NORUEGA',
    'SWITZERLAND': 'SUIZA',
    'AUSTRIA': 'AUSTRIA',
    'BELGIUM': 'BÉLGICA',
    'NETHERLANDS': 'HOLANDA',
    'POLAND': 'POLONIA',
    'GREECE': 'GRECIA',
    'UKRAINE': 'UCRANIA',
    'ROMANIA': 'RUMANIA',
    'CZECHIA': 'REPÚBLICA CHECA',
    'CZECH REP.': 'REPÚBLICA CHECA',
    'CZECH REPUBLIC': 'REPÚBLICA CHECA',
    'HUNGARY': 'HUNGRÍA',
    'DENMARK': 'DINAMARCA',
    'FINLAND': 'FINLANDIA',
    'IRELAND': 'IRLANDA',
    'CROATIA': 'CROACIA',
    'SERBIA': 'SERBIA',
    'BULGARIA': 'BULGARIA',
    'SLOVAKIA': 'ESLOVAQUIA',
    'SLOVENIA': 'ESLOVENIA',
    'LITHUANIA': 'LITUANIA',
    'LATVIA': 'LETONIA',
    'ESTONIA': 'ESTONIA',

    // Asia
    'CHINA': 'CHINA',
    'JAPAN': 'JAPÓN',
    'INDIA': 'INDIA',
    'SOUTH KOREA': 'COREA DEL SUR',
    'S. KOREA': 'COREA DEL SUR',
    'KOREA': 'COREA DEL SUR',
    'THAILAND': 'TAILANDIA',
    'VIETNAM': 'VIETNAM',
    'SINGAPORE': 'SINGAPUR',
    'INDONESIA': 'INDONESIA',
    'MALAYSIA': 'MALASIA',
    'PHILIPPINES': 'FILIPINAS',
    'PAKISTAN': 'PAKISTAN',
    'TAIWAN': 'TAIWAN',

    // Middle East
    'ISRAEL': 'ISRAEL',
    'TURKEY': 'TURQUÍA',
    'TÜRKIYE': 'TURQUÍA',
    'SAUDI ARABIA': 'ARABIA SAUDITA',
    'UNITED ARAB EMIRATES': 'EMIRATOS ÁRABES',
    'QATAR': 'QATAR',
    'KUWAIT': 'KUWAIT',
    'IRAN': 'IRÁN',
    'LEBANON': 'LÍBANO',
    'JORDAN': 'JORDANIA',

    // Africa
    'SOUTH AFRICA': 'SUDÁFRICA',
    'EGYPT': 'EGIPTO',
    'MOROCCO': 'MARRUECOS',
    'ALGERIA': 'ARGELIA',
    'NIGERIA': 'NIGERIA',
    'KENYA': 'KENIA',
    'ETHIOPIA': 'ETIOPÍA',
    'ANGOLA': 'ANGOLA',
    'LIBYA': 'LIBIA',
    'MOZAMBIQUE': 'MOZAMBIQUE',
    'GHANA': 'GHANA',
    'SENEGAL': 'SENEGAL',
    'TUNISIA': 'TÚNEZ',

    // Oceania
    'AUSTRALIA': 'AUSTRALIA',
    'NEW ZEALAND': 'NUEVA ZELANDA',
};

/**
 * Encuentra las coordenadas de un país por nombre
 * Retorna [longitude, latitude] para react-simple-maps
 */
export const getCountryCoordinates = (countryName) => {
    if (!countryName) return null;

    const normalized = countryName.toUpperCase().trim();

    if (countryCoordinates[normalized]) {
        return countryCoordinates[normalized];
    }

    // Buscar coincidencia parcial
    for (const [key, coords] of Object.entries(countryCoordinates)) {
        if (normalized.includes(key) || key.includes(normalized)) {
            return coords;
        }
    }

    return null;
};

/**
 * Check if a Natural Earth geo name matches one of our deployment countries
 */
export const matchGeoToCountry = (geoName, deploymentCountryNames) => {
    if (!geoName) return false;
    const upper = geoName.toUpperCase().trim();

    // Direct check
    if (deploymentCountryNames.has(upper)) return true;

    // Check aliases
    const alias = geoNameAliases[upper];
    if (alias && deploymentCountryNames.has(alias)) return true;

    // Partial match
    for (const name of deploymentCountryNames) {
        if (name.includes(upper) || upper.includes(name)) return true;
    }
    return false;
};

/**
 * Agrupa agregadurías por país y cuenta por fuerza
 */
export const groupByCountry = (agregaduras) => {
    const grouped = {};

    agregaduras.forEach(item => {
        if (!item.pais) return;

        const country = item.pais.toUpperCase().trim();
        const fc = item.fuerzaCodigo || item.fuerza;

        if (!grouped[country]) {
            grouped[country] = {
                country: item.pais,
                total: 0,
                EA: 0,
                ARA: 0,
                FAA: 0,
                coordinates: getCountryCoordinates(item.pais),
                items: []
            };
        }

        grouped[country].total++;
        if (fc === 'EA') grouped[country].EA++;
        if (fc === 'ARA') grouped[country].ARA++;
        if (fc === 'FAA') grouped[country].FAA++;
        grouped[country].items.push(item);
    });

    return Object.values(grouped).filter(g => g.coordinates !== null);
};
